@model DataLayer.Models.Estate

@{
    ViewData["Title"] = "جزئیات ملک";
}

<h1>جزئیات ملک</h1>

<div>
    <h4>مشخصات ملک</h4>
    <hr />
    <dl class="row">
        <dt class="col-sm-3">عنوان</dt>
        <dd class="col-sm-9">@Model.Title</dd>

        <dt class="col-sm-3">توضیحات</dt>
        <dd class="col-sm-9">@Model.Description</dd>

        <dt class="col-sm-3">استان</dt>
        <dd class="col-sm-9">@Model.Province</dd>

        <dt class="col-sm-3">شهر</dt>
        <dd class="col-sm-9">@Model.City</dd>

        <dt class="col-sm-3">آدرس</dt>
        <dd class="col-sm-9">@Model.Address</dd>

        <dt class="col-sm-3">شماره طبقه</dt>
        <dd class="col-sm-9">@Model.FloorNumber</dd>

        <dt class="col-sm-3">شماره واحد</dt>
        <dd class="col-sm-9">@Model.UnitNumber</dd>

        <dt class="col-sm-3">انباری</dt>
        <dd class="col-sm-9">@((Model.HasStorage) ? "دارد" : "ندارد")</dd>

        <dt class="col-sm-3">نوع سند</dt>
        <dd class="col-sm-9">@Model.DocumentType</dd>

        <dt class="col-sm-3">نوع ملک</dt>
        <dd class="col-sm-9">@Model.EstateType</dd>

        <dt class="col-sm-3">نوع معامله</dt>
        <dd class="col-sm-9">@Model.TransactionType</dd>

        <dt class="col-sm-3">قیمت</dt>
        <dd class="col-sm-9">
            @{
                if (Model.Prices != null && Model.Prices.Any())
                {
                    var sale = Model.Prices.FirstOrDefault(p => p.PriceType == DataLayer.Enums.PriceTypeEnum.Sale);
                    var rent = Model.Prices.FirstOrDefault(p => p.PriceType == DataLayer.Enums.PriceTypeEnum.Rent);
                    var mortgage = Model.Prices.FirstOrDefault(p => p.PriceType == DataLayer.Enums.PriceTypeEnum.Mortgage);

                    @if (Model.TransactionType == DataLayer.Enums.TransactionTypeEnum.Sale && sale != null)
                    {
                        <span>@sale.Amount.ToString("N0") تومان</span>
                    }
                    else if (Model.TransactionType == DataLayer.Enums.TransactionTypeEnum.Rent && (rent != null || mortgage != null))
                    {
                        <span>رهن: @(mortgage?.Amount.ToString("N0") ?? "0") تومان</span>
                        <br />
                        <span>اجاره: @(rent?.Amount.ToString("N0") ?? "0") تومان</span>
                    }
                    else if (Model.TransactionType == DataLayer.Enums.TransactionTypeEnum.Mortgage && mortgage != null)
                    {
                        <span>@mortgage.Amount.ToString("N0") تومان</span>
                    }
                    else
                    {
                        <span>قیمت ثبت نشده است</span>
                    }

                }
                else
                {
                    <span>قیمت ثبت نشده است</span>
                }
            }
        </dd>

        <dt class="col-sm-3">ایمیل کاربر</dt>
        <dd class="col-sm-9">@Model.User?.Email</dd>

        <dt class="col-sm-3">تاریخ ثبت</dt>
        <dd class="col-sm-9">@Model.CreationDate.ToString("yyyy/MM/dd HH:mm")</dd>
    </dl>
</div>

<div>
    <a asp-action="Edit" asp-route-id="@Model?.Id" class="btn btn-primary">ویرایش</a>
    <a asp-action="Index" class="btn btn-secondary">بازگشت به لیست</a>
</div>
